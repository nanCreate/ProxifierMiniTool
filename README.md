# ProxifierMiniTool
Маленький скрипт для генерации путей к `.exe` файлам в выбранном каталоге. 
Список форматируется таким образом, чтобы можно было легко "скормить" в "Proxification Rules"

# Зачем?
Если указать Proxifier правило проксирования определённого процесса, то запущенные дочерние процессы не будут автоматически попадать в список правил. 

Скрипт позволяет проанализировать папку нужной программы на наличие всех `.exe` чтобы легко вставить пути в правила проксирования. Таким образом, дочерние процессы, которые несёт за собой программа (если находятся в том же каталоге), будут подпадать под заданное правило. 

## Пример:

Установлена игра в `C:\КрутаяИгра\`, мы видимо что в этом каталоге за запуск игры отвечает файл `C:\КрутаяИгра\Launcher.exe`. Начинаем добавлять правило в Proxifier чтобы процесс с именем `Launcher.exe` проксировался. 

Запускаем игру, а игра почему-то игнорирует заданное правило. 

Ответ кроется в том, что `Launcher.exe` лишь отвечает за лончер игры, а дочерний процесс самой игры находится, допустим по пути `C:\КрутаяИгра\bin\game.exe`. Приходится добавлять вручную и этот процесс. 

Снова запускаем и игра опять игнорирует правило. Узнаём что ещё есть дочерний процесс `updater.exe`, который расположен в `C:\Крутаяигра\utils\updater.exe`

И так до бесконечности. 

## Решение проблемы:

На помощь приходит ProxifierMiniTool, которой можно просканировать `C:\КрутаяИгра\` на наличие исполняемых файлов (`.exe`) и сразу вставить сгенерированный список в правила Proxifier

# Установка

## 1. Установка Python 

### Способ через Chocolatey
```bash
choco install python -y
```
### Через официальный сайт:
[https://www.python.org/downloads/](https://www.python.org/downloads/)

## 2. Установка зависимостей

```bash
pip install pyperclip
```

## 3. Установка скрипта

### 3.1. Скачайте последнюю актуальную версию из [страницы релизов](https://github.com/nanCreate/ProxifierMiniTool/releases)

### 3.2. Создайте ярлык скрипта в контекстном меню "Отправить" (необязательно, но рекомендуется)

- Для этого нажмите сочетание клавиш `win+r`;
- Введите в поле `shell:sendto`;
- В открывшемся каталоге создайте ярлык на скрипт (`main.py`). Название ярлыка введите по своему предпочтению.

# Использование

Предполагается два способа использования скрипта

## Через контекстное меню "Отправить" (при условии если выполнен пункт 3.2)
- Нажмите правой кнопкой мыши по нужной папке;
- Наведите на пункт "Отправить" (Send to);
- В появившемся найдите и выберите скрипт;
- После процесса генерации, данные будут скопированы в буфер обмена;
- Вставьте данные в Proxifier.

## Вызов через терминал
```bash
"путь\к\main.py" "путь к папке для сканирования"
```

- После процесса генерации, данные будут скопированы в буфер обмена; 
- Вставьте данные в Proxifier.

